---
layout: post
title: "慢查询检测——需求分析"
author: "见欢"
---
### 现状
{% highlight markdown %}
  一般成熟的公司都会有DBA这样的角色，他们借助一些自研的db相关产品，负责保证业务数据的高可用，
统计和监控线上数据库的性能情况。我所在的公司就有udc、idb这样的产品。类似慢查询、性能监控这一
块，它们能协助业务快速定位问题。
  尽管如此，仍然无法杜绝线上慢查询的产生，业务在发展，花费很大的精力排查每个版本的潜在慢查询并
不现实，只有不断提高业务相关同学的避免慢查询的意识和对慢查询的分析能力，并提供一套有效的系统才
能很好的减少线上慢查询，减少数据库没必要的压力。
  有些慢查询，新增了已有的大表查询纬度，上线后直接导致了慢查询，系统响应时间增长，无果不能及时
处理，数据库的处理能力马上达到瓶颈，系统可能无法响应正常请求。另一些则可能是新的业务，随着时间
的推移，数据快速累加，逐渐出现慢查询，轻则降低系统平均响应时间，重则导致系统不可用。
{% endhighlight %}

### 需求
{% highlight markdown %}
  决定实现慢查询分析系统，接下来就需要梳理整体需求，从以下几个方面考虑。
{% endhighlight %}
##### 1、接入成本
{% highlight markdown %}
  接入成本是首先要考虑的因素，系统能否推广，很大程度取决于接入成本，因此系统实现必须是方便接入
的，同时应该尽量减少用户配置。
{% endhighlight %}
##### 2、使用成本
{% highlight markdown %}
  需要定义系统的使用方式和流程，用户能够快速理解使用方式和流程，配合操作提示或演示。同时配合告
警，通知功能。
{% endhighlight %}
##### 3、系统扩展性
{% highlight markdown %}
  系统实现时应该有意识地考虑扩展性，以快速支持新功能开发，扩展性包括但不局限于系统架构、代码组
织；
{% endhighlight %}
##### 3、效果量化
{% highlight markdown %}
  实现一套系统，需要量化效果，设计的时候需要包含效果统计，包含使用频率等。
{% endhighlight %}